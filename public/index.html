<!DOCTYPE html>
<html>

<head>
  <title>FilePond from CDN</title>

  <!-- Filepond stylesheet -->
  <link href="./resources/filepond.css" rel="stylesheet">
  <style>
    .download-files {
      width: 100%;
      padding: 10px 0;
    }

    .download-files li a {
      color: white;
      text-decoration: none;
      background-color: #369763;
      margin: 10px 0;
      display: block;
      padding: 10px;
      list-style: none;
      border-radius: 5px;
    }
  </style>

</head>

<body>

  <!-- We'll transform this input into a pond -->
  <input type="file" class="filepond" data-max-files="10" multiple>

  <ul class="download-files">
  </ul>

  <!-- Load FilePond library -->
  <script src="./resources/filepond.js"></script>

  <!-- Turn all file input elements into ponds -->
  <script>
    FilePond.setOptions({
      server: './upload/',
    });
    FilePond.parse(document.body);

    const pond = document.querySelector('.filepond');
    pond.addEventListener('FilePond:addfile', e => {
      console.log('File added', e.detail);
    });

    function refreshFileList() {
      fetch('./filelist').then(response => response.json()).then(json => {
        const lis = json.map(data =>
          `
          <li>
            <a href="./download/${data.filename}">${data.filename}</a>
          </li>
        `
        ).join(' ');

        const ul = document.querySelector('.download-files');
        ul.innerHTML = lis;
      })
    }

    refreshFileList();
  </script>

</body>

</html>